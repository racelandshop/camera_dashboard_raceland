const __DEMO__ = false;
    const __SUPERVISOR__ = true;
    const __BUILD__ = "latest"

import { _ as _decorate, l as a, d as e, t, j as _get, k as _getPrototypeOf } from './main-dev.js';
import 'lit-html/is-server.js';
import { W as findEntities, aa as computeCardSize, U as processConfigEntities, ab as createCardElement } from './ha-more-info-dialog-dev.js';
import './ha-header-bar-dev.js';
import './mwc-tab-bar-dev.js';
import './auth-dev.js';
import './stop_propagation-dev.js';
import './ha-circular-progress-dev.js';
import './repeat-dev.js';

const evaluateFilter=(stateObj,filter)=>{var _filter$value;const operator=filter.operator||"==";const value=(_filter$value=filter.value)!==null&&_filter$value!==void 0?_filter$value:filter;const state=filter.attribute?stateObj.attributes[filter.attribute]:stateObj.state;switch(operator){case"==":return state===value;case"<=":return state<=value;case"<":return state<value;case">=":return state>=value;case">":return state>value;case"!=":return state!==value;case"in":if(Array.isArray(value)||typeof value==="string"){return value.includes(state);}return false;case"not in":if(Array.isArray(value)||typeof value==="string"){return !value.includes(state);}return false;case"regex":{if(state!==null&&typeof state==="object"){return RegExp(value).test(JSON.stringify(state));}return RegExp(value).test(state);}default:return false;}};

let EntityFilterCard=_decorate(null,function(_initialize,_ReactiveElement){class EntityFilterCard extends _ReactiveElement{constructor(...args){super(...args);_initialize(this);}}return {F:EntityFilterCard,d:[{kind:"method",static:true,key:"getStubConfig",value:function getStubConfig(hass,entities,entitiesFallback){const maxEntities=3;const foundEntities=findEntities(hass,maxEntities,entities,entitiesFallback,["light","switch","sensor"]);return {type:"entity-filter",entities:foundEntities,state_filter:[foundEntities[0]?hass.states[foundEntities[0]].state:""],card:{type:"entities"}};}},{kind:"field",decorators:[e({attribute:false})],key:"hass",value:void 0},{kind:"field",decorators:[e()],key:"isPanel",value(){return false;}},{kind:"field",decorators:[e()],key:"editMode",value(){return false;}},{kind:"field",decorators:[t()],key:"_config",value:void 0},{kind:"field",key:"_element",value:void 0},{kind:"field",key:"_configEntities",value:void 0},{kind:"field",key:"_baseCardConfig",value:void 0},{kind:"field",key:"_oldEntities",value:void 0},{kind:"method",key:"getCardSize",value:function getCardSize(){return this._element?computeCardSize(this._element):1;}},{kind:"method",key:"setConfig",value:function setConfig(config){if(!config.entities.length||!Array.isArray(config.entities)){throw new Error("Entities must be specified");}if(!(config.state_filter&&Array.isArray(config.state_filter))&&!config.entities.every(entity=>typeof entity==="object"&&entity.state_filter&&Array.isArray(entity.state_filter))){throw new Error("Incorrect filter config");}this._configEntities=processConfigEntities(config.entities);this._config=config;this._baseCardConfig={type:"entities",entities:[],...this._config.card};if(this.lastChild){this.removeChild(this.lastChild);}this._element=this._createCardElement(this._baseCardConfig);}},{kind:"method",key:"createRenderRoot",value:function createRenderRoot(){return this;}},{kind:"method",key:"shouldUpdate",value:function shouldUpdate(changedProps){if(this._element){this._element.hass=this.hass;this._element.editMode=this.editMode;this._element.isPanel=this.isPanel;}if(changedProps.has("_config")){return true;}if(changedProps.has("hass")){return this._haveEntitiesChanged(changedProps.get("hass"));}return false;}},{kind:"method",key:"update",value:function update(changedProps){_get(_getPrototypeOf(EntityFilterCard.prototype),"update",this).call(this,changedProps);if(!this.hass||!this._config||!this._configEntities||!this._element){return;}const entitiesList=this._configEntities.filter(entityConf=>{const stateObj=this.hass.states[entityConf.entity];if(!stateObj){return false;}if(entityConf.state_filter){for(const filter of entityConf.state_filter){if(evaluateFilter(stateObj,filter)){return true;}}}else {for(const filter of this._config.state_filter){if(evaluateFilter(stateObj,filter)){return true;}}}return false;});if(entitiesList.length===0&&this._config.show_empty===false){this.style.display="none";return;}if(!this.lastChild){this._element.setConfig({...this._baseCardConfig,entities:entitiesList});this._oldEntities=entitiesList;}else if(this._element.tagName!=="HUI-ERROR-CARD"){const isSame=this._oldEntities&&entitiesList.length===this._oldEntities.length&&entitiesList.every((entity,idx)=>entity===this._oldEntities[idx]);if(!isSame){this._oldEntities=entitiesList;this._element.setConfig({...this._baseCardConfig,entities:entitiesList});}}// Attach element if it has never been attached.
if(!this.lastChild){this.appendChild(this._element);}this.style.display="block";}},{kind:"method",key:"_haveEntitiesChanged",value:function _haveEntitiesChanged(oldHass){if(!this.hass||!oldHass){return true;}if(!this._configEntities){return true;}if(this.hass.localize!==oldHass.localize){return true;}for(const config of this._configEntities){if(this.hass.states[config.entity]!==oldHass.states[config.entity]){return true;}}return false;}},{kind:"method",key:"_createCardElement",value:function _createCardElement(cardConfig){const element=createCardElement(cardConfig);if(this.hass){element.hass=this.hass;}element.isPanel=this.isPanel;element.editMode=this.editMode;element.addEventListener("ll-rebuild",ev=>{ev.stopPropagation();this._rebuildCard(element,cardConfig);},{once:true});return element;}},{kind:"method",key:"_rebuildCard",value:function _rebuildCard(cardElToReplace,config){const newCardEl=this._createCardElement(config);if(cardElToReplace.parentElement){cardElToReplace.parentElement.replaceChild(newCardEl,cardElToReplace);}this._element=newCardEl;}}]};},a);customElements.define("hui-entity-filter-card",EntityFilterCard);
